<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>티켓츠 tCATS - MVP</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Malgun Gothic', sans-serif;
            background: linear-gradient(135deg, #E15E6E 0%, #F06292 100%);
            min-height: 100vh;
            padding: 0;
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 100%;
            margin: 0;
            background: white;
            min-height: 100vh;
        }

        /* 헤더 */
        .header {
            background: linear-gradient(135deg, #E15E6E 0%, #F06292 100%);
            color: white;
            padding: 20px 15px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 5px;
            font-weight: 700;
        }

        .header p {
            font-size: 12px;
            opacity: 0.95;
        }

        /* 탭 버튼 */
        .tab-buttons {
            display: flex;
            background: #f8f8f8;
            border-bottom: 2px solid #e0e0e0;
            position: sticky;
            top: 80px;
            z-index: 99;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .tab-buttons::-webkit-scrollbar {
            display: none;
        }

        .tab-btn {
            flex: 1;
            min-width: 100px;
            padding: 15px 10px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            color: #666;
            transition: all 0.3s;
            white-space: nowrap;
            border-bottom: 3px solid transparent;
        }

        .tab-btn.active {
            background: white;
            color: #E15E6E;
            border-bottom-color: #E15E6E;
        }

        /* 탭 내용 */
        .tab-content {
            display: none;
            padding: 15px;
            animation: fadeIn 0.3s;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* 카드 스타일 */
        .card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            border: 1px solid #f0f0f0;
        }

        .card-title {
            font-size: 18px;
            font-weight: 700;
            color: #E15E6E;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .card-subtitle {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin: 15px 0 10px;
            padding-left: 10px;
            border-left: 3px solid #E15E6E;
        }

        /* 체크박스 */
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin: 10px 0;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: #f8f8f8;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .checkbox-item:active {
            background: #f0f0f0;
            transform: scale(0.98);
        }

        .checkbox-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .checkbox-item label {
            flex: 1;
            font-size: 15px;
            cursor: pointer;
        }

        /* 결과 박스 */
        .result-box {
            background: linear-gradient(135deg, #fff5f7 0%, #ffe8ec 100%);
            border: 2px solid #E15E6E;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            margin: 15px 0;
        }

        .result-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
        }

        .result-value {
            font-size: 32px;
            font-weight: 700;
            color: #E15E6E;
            line-height: 1.2;
        }

        /* 버튼 */
        .btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin: 8px 0;
        }

        .btn-primary {
            background: linear-gradient(135deg, #E15E6E 0%, #F06292 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(225, 94, 110, 0.3);
        }

        .btn-primary:active {
            transform: scale(0.98);
            box-shadow: 0 2px 8px rgba(225, 94, 110, 0.3);
        }

        .btn-secondary {
            background: white;
            color: #E15E6E;
            border: 2px solid #E15E6E;
        }

        .btn-secondary:active {
            background: #fff5f7;
        }

        /* 통계 그리드 */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .stat-item {
            background: linear-gradient(135deg, #E15E6E 0%, #F06292 100%);
            color: white;
            border-radius: 12px;
            padding: 15px 10px;
            text-align: center;
        }

        .stat-label {
            font-size: 11px;
            margin-bottom: 5px;
            opacity: 0.9;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
        }

        /* 테이블 - 모바일 최적화 */
        .table-wrapper {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            margin: 15px -20px;
            padding: 0 20px;
        }

        .table {
            width: 100%;
            min-width: 600px;
            border-collapse: collapse;
            background: white;
        }

        .table th,
        .table td {
            padding: 12px 8px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
            font-size: 13px;
        }

        .table th {
            background: #E15E6E;
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .table tr:last-child td {
            border-bottom: none;
        }

        /* 좌석 배정 섹션 */
        .seat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(45px, 1fr));
            gap: 8px;
            margin: 15px 0;
        }

        .seat-btn {
            aspect-ratio: 1;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background: white;
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .seat-btn.reserved {
            background: #f0f0f0;
            color: #999;
            cursor: not-allowed;
        }

        .seat-btn.selected {
            background: #E15E6E;
            color: white;
            border-color: #E15E6E;
        }

        /* DM 카드 */
        .dm-card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .dm-card:active {
            transform: scale(0.98);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .dm-card-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .dm-card-info {
            font-size: 13px;
            color: #666;
            margin-bottom: 5px;
        }

        .dm-card-discount {
            display: inline-block;
            background: #E15E6E;
            color: white;
            padding: 4px 10px;
            border-radius: 5px;
            font-size: 12px;
            font-weight: 600;
        }

        /* QR 코드 */
        .qr-display {
            background: white;
            border: 3px solid #E15E6E;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin: 20px 0;
        }

        .qr-code {
            width: 200px;
            height: 200px;
            margin: 0 auto 15px;
            background: #f8f8f8;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
            border-radius: 10px;
        }

        .qr-info {
            font-size: 14px;
            color: #666;
            line-height: 1.6;
        }

        /* 별점 */
        .star-rating {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }

        .star {
            font-size: 40px;
            cursor: pointer;
            transition: all 0.2s;
            color: #ddd;
        }

        .star.active {
            color: #FFD700;
        }

        .star:active {
            transform: scale(1.2);
        }

        /* 알림 */
        .alert {
            background: #E15E6E;
            color: white;
            padding: 12px 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-size: 14px;
            text-align: center;
            animation: slideDown 0.3s;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* 입력 필드 */
        .input-group {
            margin: 15px 0;
        }

        .input-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .input-field {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 15px;
            transition: all 0.2s;
        }

        .input-field:focus {
            outline: none;
            border-color: #E15E6E;
        }

        /* 로딩 애니메이션 */
        .loading {
            text-align: center;
            padding: 20px;
            color: #E15E6E;
        }

        .loading:after {
            content: '...';
            animation: dots 1.5s infinite;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }

        /* 배지 */
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 5px;
        }

        .badge-success {
            background: #4CAF50;
            color: white;
        }

        .badge-warning {
            background: #FF9800;
            color: white;
        }

        .badge-danger {
            background: #F44336;
            color: white;
        }

        /* 구분선 */
        .divider {
            height: 1px;
            background: #e0e0e0;
            margin: 20px 0;
        }

        /* 반응형 추가 */
        @media (max-width: 480px) {
            .header h1 {
                font-size: 20px;
            }

            .card-title {
                font-size: 16px;
            }

            .result-value {
                font-size: 28px;
            }

            .stats-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 8px;
            }

            .stat-item {
                padding: 12px 8px;
            }

            .stat-label {
                font-size: 10px;
            }

            .stat-value {
                font-size: 20px;
            }

            .seat-grid {
                grid-template-columns: repeat(auto-fill, minmax(40px, 1fr));
                gap: 6px;
            }

            .qr-code {
                width: 180px;
                height: 180px;
                font-size: 70px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 헤더 -->
        <div class="header">
            <img src="logo.png" alt="tCATS 로고" style="height: 60px; margin-bottom: 10px;">
            <h1>티켓츠 tCATS</h1>
            <p>공연 데이터 통합 플랫폼</p>
        </div>

        <!-- 탭 버튼 -->
        <div class="tab-buttons">
            <button class="tab-btn active" onclick="showTab('admin')">관리자</button>
            <button class="tab-btn" onclick="showTab('partner')">제작사</button>
            <button class="tab-btn" onclick="showTab('user')">회원</button>
        </div>

        <!-- 관리자 백오피스 -->
        <div id="admin" class="tab-content active">
            <!-- 1. 통합 명부 생성 -->
            <div class="card">
                <div class="card-title">📋 1. 통합 명부 생성</div>
                <p style="font-size: 13px; color: #666; margin-bottom: 15px;">
                    여러 예매처의 예약자 명단을 하나로 통합합니다.
                </p>
                <button class="btn btn-secondary" onclick="uploadFiles()">
                    📁 예매처 파일 업로드
                </button>
                <div id="uploadResult"></div>
            </div>

            <!-- 2. 예약자 리스트 -->
            <div class="card">
                <div class="card-title">👥 2. 예약자 리스트</div>
                <div class="table-wrapper">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>예매번호</th>
                                <th>예매처</th>
                                <th>이름</th>
                                <th>좌석정보</th>
                                <th>수량</th>
                                <th>상태</th>
                            </tr>
                        </thead>
                        <tbody id="attendanceTable">
                            <tr>
                                <td>IP20251015001</td>
                                <td>인터파크</td>
                                <td>김철수</td>
                                <td>R석 A-15, A-16</td>
                                <td>2</td>
                                <td><span class="badge badge-success">✓ 지정</span></td>
                            </tr>
                            <tr>
                                <td>YES20251015002</td>
                                <td>예스24</td>
                                <td>이영희</td>
                                <td>-</td>
                                <td>3</td>
                                <td><span class="badge badge-warning">자동배정</span></td>
                            </tr>
                            <tr>
                                <td>INT20251015003</td>
                                <td>인터파크</td>
                                <td>박민수</td>
                                <td>S석 B-10</td>
                                <td>1</td>
                                <td><span class="badge badge-success">✓ 지정</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 3. 자동 좌석 배정 -->
            <div class="card">
                <div class="card-title">💺 3. 자동 좌석 배정</div>
                <p style="font-size: 13px; color: #666; margin-bottom: 15px;">
                    비지정석 예매자에게 최적의 좌석을 자동으로 배정합니다.
                </p>
                <div class="seat-grid" id="seatGrid"></div>
                <button class="btn btn-primary" onclick="autoAssignSeats()">
                    자동 배정 실행
                </button>
            </div>

            <!-- 4. 통합 통계 -->
            <div class="card">
                <div class="card-title">📊 4. 통합 통계</div>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-label">총 예매자수</div>
                        <div class="stat-value">247명</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">QR 발권수</div>
                        <div class="stat-value" id="qrIssued">185명</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">현재 입장객</div>
                        <div class="stat-value" id="currentEntry">142명</div>
                    </div>
                </div>
                <button class="btn btn-secondary" onclick="refreshAdminStats()">
                    🔄 실시간 새로고침
                </button>
            </div>
        </div>

        <!-- 제작사 대시보드 -->
        <div id="partner" class="tab-content">
            <!-- 1. 타겟 관객 선택 -->
            <div class="card">
                <div class="card-title">🎯 1. 타겟 관객 선택</div>
                
                <div class="card-subtitle">연령대</div>
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="age20" checked onchange="updateTargetCount()">
                        <label for="age20">20대</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="age30" checked onchange="updateTargetCount()">
                        <label for="age30">30대</label>
                    </div>
                </div>

                <div class="card-subtitle">선호 장르</div>
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="musical" checked onchange="updateTargetCount()">
                        <label for="musical">뮤지컬</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="play" onchange="updateTargetCount()">
                        <label for="play">연극</label>
                    </div>
                </div>

                <div class="result-box">
                    <div class="result-label">예상 타겟 수:</div>
                    <div class="result-value" id="targetCount">1,247명</div>
                </div>
            </div>

            <!-- 2. DM 발송 -->
            <div class="card">
                <div class="card-title">💌 2. DM 발송</div>
                
                <div class="input-group">
                    <label class="input-label">공연 제목</label>
                    <input type="text" class="input-field" id="showTitle" placeholder="공연 제목을 입력하세요" value="뮤지컬 <시카고>">
                </div>

                <div class="input-group">
                    <label class="input-label">할인율</label>
                    <input type="text" class="input-field" id="discountRate" placeholder="예: 30%" value="30%">
                </div>

                <div class="input-group">
                    <label class="input-label">메시지 내용</label>
                    <textarea class="input-field" id="dmMessage" rows="4" placeholder="관객에게 전달할 메시지를 입력하세요">브로드웨이 최고의 뮤지컬 <시카고>를 특별한 가격으로 만나보세요!</textarea>
                </div>

                <button class="btn btn-primary" onclick="sendDM()">
                    📨 DM 발송하기
                </button>
                <div id="dmResult"></div>
            </div>

            <!-- 3. 마케팅 성과 -->
            <div class="card">
                <div class="card-title">📊 3. 마케팅 성과</div>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-label">오픈율</div>
                        <div class="stat-value" id="openRate">0%</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">클릭율</div>
                        <div class="stat-value" id="clickRate">0%</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">전환율</div>
                        <div class="stat-value" id="conversionRate">0%</div>
                    </div>
                </div>
                <button class="btn btn-secondary" onclick="updateStats()">
                    📈 성과 확인
                </button>
            </div>
        </div>

        <!-- 회원 모드 -->
        <div id="user" class="tab-content">
            <!-- 1. DM 수신함 -->
            <div class="card">
                <div class="card-title">💌 1. 받은 DM</div>
                
                <div class="dm-card" onclick="showDMDetail()">
                    <div class="dm-card-title">뮤지컬 <시카고></div>
                    <div class="dm-card-info">📅 2025.11.15 - 11.30</div>
                    <div class="dm-card-info">📍 예술의전당 CJ토월극장</div>
                    <div class="dm-card-discount">30% 특별 할인</div>
                </div>

                <div class="dm-card">
                    <div class="dm-card-title">연극 <햄릿></div>
                    <div class="dm-card-info">📅 2025.11.20 - 12.10</div>
                    <div class="dm-card-info">📍 대학로 예술극장</div>
                    <div class="dm-card-discount">20% 조기예매 할인</div>
                </div>
            </div>

            <!-- 2. QR 발급 -->
            <div class="card">
                <div class="card-title">🎫 2. QR 입장권 발급</div>
                
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="agreeInfo">
                        <label for="agreeInfo" style="font-size: 13px;">
                            관객 정보 활용에 동의합니다 (선택)
                        </label>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="generateQR()">
                    QR 발급받기
                </button>

                <div id="qrDisplay"></div>
            </div>

            <!-- 3. 리뷰 & 리워드 -->
            <div class="card">
                <div class="card-title">⭐ 3. 리뷰 & 리워드</div>
                <p style="font-size: 13px; color: #666; margin-bottom: 15px;">
                    공연 만족도를 평가하고 리워드를 받으세요!
                </p>
                
                <div class="card-subtitle">공연은 어떠셨나요?</div>
                <div class="star-rating">
                    <span class="star" onclick="setRating(1)">★</span>
                    <span class="star" onclick="setRating(2)">★</span>
                    <span class="star" onclick="setRating(3)">★</span>
                    <span class="star" onclick="setRating(4)">★</span>
                    <span class="star" onclick="setRating(5)">★</span>
                </div>

                <div class="input-group">
                    <label class="input-label">한줄평을 남겨주세요</label>
                    <textarea class="input-field" rows="3" placeholder="공연 후기를 작성해주세요 (선택)"></textarea>
                </div>

                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="recommend">
                        <label for="recommend">지인에게 추천하고 싶어요</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="revisit">
                        <label for="revisit">다시 관람하고 싶어요</label>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="submitReview()">
                    평가 제출하기
                </button>
                <div id="reviewResult"></div>
            </div>
        </div>
    </div>

    <script>
        // 탭 전환
        function showTab(tabName) {
            // 모든 탭 숨기기
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // 선택한 탭 보이기
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            // 맨 위로 스크롤
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // 타겟 카운트 업데이트
        function updateTargetCount() {
            let count = 0;
            const age20 = document.getElementById('age20').checked;
            const age30 = document.getElementById('age30').checked;
            const musical = document.getElementById('musical').checked;
            const play = document.getElementById('play').checked;

            // 간단한 계산 로직
            if (age20) count += 650;
            if (age30) count += 597;
            if (musical && !play) count = Math.floor(count * 1.0);
            if (play && !musical) count = Math.floor(count * 0.6);
            if (musical && play) count = Math.floor(count * 1.2);

            document.getElementById('targetCount').textContent = count.toLocaleString() + '명';
        }

        // 관리자 통계 새로고침
        function refreshAdminStats() {
            const qrIssued = document.getElementById('qrIssued');
            const currentEntry = document.getElementById('currentEntry');
            
            // 랜덤하게 증가
            const qr = 185 + Math.floor(Math.random() * 15);
            const entry = 142 + Math.floor(Math.random() * 20);
            
            qrIssued.textContent = qr + '명';
            currentEntry.textContent = entry + '명';
            
            alert('✅ 통계가 업데이트되었습니다!\n\nQR 발권: ' + qr + '명\n현재 입장: ' + entry + '명');
        }

        // 파일 업로드
        function uploadFiles() {
            const resultDiv = document.getElementById('uploadResult');
            resultDiv.innerHTML = '<div class="loading">파일 업로드 중</div>';
            
            setTimeout(() => {
                resultDiv.innerHTML = `
                    <div class="alert">
                        ✅ 3개 예매처 파일 통합 완료!<br>
                        총 247명의 예약자가 통합되었습니다.
                    </div>
                `;
            }, 1500);
        }

        // 좌석 그리드 생성
        function initSeatGrid() {
            const seatGrid = document.getElementById('seatGrid');
            const rows = ['A', 'B', 'C', 'D'];
            const seats = [];

            rows.forEach(row => {
                for (let i = 1; i <= 10; i++) {
                    const seatBtn = document.createElement('button');
                    seatBtn.className = 'seat-btn';
                    seatBtn.textContent = row + i;
                    
                    // 일부 좌석은 이미 예약됨
                    if (Math.random() > 0.6) {
                        seatBtn.classList.add('reserved');
                    }
                    
                    seatGrid.appendChild(seatBtn);
                }
            });
        }

        // 자동 좌석 배정
        function autoAssignSeats() {
            const seats = document.querySelectorAll('.seat-btn:not(.reserved)');
            let assigned = 0;
            
            seats.forEach((seat, index) => {
                if (index < 5) { // 5명 배정
                    setTimeout(() => {
                        seat.classList.add('selected');
                        assigned++;
                        if (assigned === 5) {
                            alert('✅ 5명의 비지정석 예매자에게 좌석이 자동 배정되었습니다!');
                        }
                    }, index * 200);
                }
            });
        }

        // 통계 업데이트
        function updateStats() {
            const stats = [
                { id: 'openRate', value: 85 },
                { id: 'clickRate', value: 42 },
                { id: 'conversionRate', value: 18 }
            ];

            stats.forEach(stat => {
                animateValue(stat.id, 0, stat.value, 1000);
            });
        }

        function animateValue(id, start, end, duration) {
            const element = document.getElementById(id);
            const range = end - start;
            const increment = range / (duration / 16);
            let current = start;

            const timer = setInterval(() => {
                current += increment;
                if (current >= end) {
                    current = end;
                    clearInterval(timer);
                }
                element.textContent = Math.round(current) + '%';
            }, 16);
        }

        // DM 발송
        function sendDM() {
            const resultDiv = document.getElementById('dmResult');
            resultDiv.innerHTML = '<div class="loading">DM 발송 중</div>';
            
            setTimeout(() => {
                resultDiv.innerHTML = `
                    <div class="alert">
                        ✅ 1,247명에게 DM이 발송되었습니다!<br>
                        관리자 승인 후 전달됩니다.
                    </div>
                `;
                updateStats();
            }, 2000);
        }

        // DM 상세보기
        function showDMDetail() {
            alert('🎭 뮤지컬 <시카고>\n\n브로드웨이 최고의 뮤지컬을 특별한 가격으로!\n\n📅 2025.11.15 - 11.30\n📍 예술의전당 CJ토월극장\n💰 30% 특별 할인');
        }

        // QR 생성
        function generateQR() {
            const agree = document.getElementById('agreeInfo').checked;
            const qrDisplay = document.getElementById('qrDisplay');
            
            qrDisplay.innerHTML = '<div class="loading">QR 생성 중</div>';
            
            setTimeout(() => {
                qrDisplay.innerHTML = `
                    <div class="qr-display">
                        <div class="qr-code">📱</div>
                        <div class="qr-info">
                            <strong>뮤지컬 <시카고></strong><br>
                            2025.11.15 (금) 19:30<br>
                            R석 A-15, A-16<br>
                            ${agree ? '<br>✅ 정보 활용 동의 완료' : ''}
                        </div>
                    </div>
                `;
            }, 1500);
        }

        // 별점 설정
        function setRating(rating) {
            const stars = document.querySelectorAll('.star');
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.classList.add('active');
                } else {
                    star.classList.remove('active');
                }
            });
        }

        // 리뷰 제출
        function submitReview() {
            const rating = document.querySelectorAll('.star.active').length;
            const recommend = document.getElementById('recommend').checked;
            const revisit = document.getElementById('revisit').checked;
            
            if (rating === 0) {
                alert('⭐ 별점을 선택해주세요!');
                return;
            }

            const resultDiv = document.getElementById('reviewResult');
            let points = rating * 200; // 별 1개당 200포인트
            if (recommend) points += 200;
            if (revisit) points += 200;

            resultDiv.innerHTML = `
                <div class="alert">
                    ✅ 평가가 완료되었습니다!<br>
                    ${points}P가 적립되었습니다 💰<br>
                    (1,000P = 1,000원)
                </div>
            `;
        }

        // 페이지 로드 시 초기화
        window.onload = function() {
            initSeatGrid();
        };
    </script>
</body>
</html>
